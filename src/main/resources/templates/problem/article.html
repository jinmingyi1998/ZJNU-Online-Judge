<!--
  ~ Copyright (c) 2019. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  ~ Morbi non lorem porttitor neque feugiat blandit. Ut vitae ipsum eget quam lacinia accumsan.
  ~ Etiam sed turpis ac ipsum condimentum fringilla. Maecenas magna.
  ~ Proin dapibus sapien vel ante. Aliquam erat volutpat. Pellentesque sagittis ligula eget metus.
  ~ Vestibulum commodo. Ut rhoncus gravida arcu.
  -->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" >
<head>
    <th:block th:insert="~{fragment/header :: header}"></th:block>
    <meta charset="UTF-8">
    <title th:text="|题解 of ${problem.title}|"></title>
    <script src="/js/remarkable.min.js"></script>
    <link rel="stylesheet" href="/editor/css/editormd.min.css">
    <script src="/editor/editormd.min.js"></script>
</head>
<body>
<main class="container" th:id="${problem.id}">
    <div class="card mt-5 p-3">
        <h2 class=" text-center" th:text="|${problem.title} - 题解|"></h2>
        <div class="card-body">
            <p class="card-text">
                <span class="font-weight-bold lead">以下题解仅供学习参考使用。</span>
            </p>
            <p class="card-text">
                <b class="text-danger">抄袭</b> 、<b class="text-danger">复制</b>题解，以达到刷AC率/AC数量或其他目的的行为，是严格禁止的。此类行为将会导致您成为
                <b>作弊者</b>。
            </p>
        </div>
    </div>
    <div class="card mt-2"  id="article-list">
        <div class="card-body" v-for="a in articles">
            <p class="card-text text-muted"><span class="m-3">作者：<a v-bind:href="authorHref(a.author.id)">{{a.author.username}}</a>
            </span><span class="m-3">{{postTime(a.normalPostTime)}}</span></p>
            <hr>
            <!--<div class="card-text md-text" v-html="a.text"></div>-->
            <div class="card-text md-text axt"></div>
        </div>
    </div>
    <div class="container-fluid mt-5 justify-content-sm-center">
        <form action="" class="mt-1 justify-content-center" method="post">
            <div class="form-group" id="editormd">
                <textarea name="text" class="w-100"></textarea></div>
            <input type="submit" th:value="发布" class="text-center text-light btn btn-primary mt-3 justify-content-center">
        </form>
    </div>
</main>
<script>
    var arti=new Vue({
       el:'#article-list',
       data:{
           articles:[]
       },
       methods:{
           postTime:function (str) {
               return "发布时间 "+str;
           },
           authorHref:function (str) {
               return "/user/"+str;
           }
       }
    });
    $.get({
        url:'/problems/rest/article/'+$("main").attr("id"),
        success:function (res) {
            arti._data.articles=res;

        }
    });
    var markdown=new showdown.Converter({
        openLinksInNewWindow:true
    });
    markdown.setFlavor('github');
    var editor = editormd({
        id: "editormd",
        path: "/editor/lib/",
        height: 300,
        codeFold: true,
        saveHTMLToTextarea: true,
        searchReplace: true,
        emoji: true,
        taskList: false,
        tocm: false,
        tex: false,
        autoFocus: false,
        flowChart: false,
        sequenceDiagram: false
    });
    $(function () {
            $(".axt").each(function () {
                $(this).html(arti._data.articles[0].text);
            })
        setTimeout(function () {
            $(".md-text").each(function () {

                console.log($(this).html());
                $(this).html(markdown.makeHtml($(this).html()));
            });
        }, 5000);
    });
</script>
<footer th:replace="~{fragment/footer :: footer}"></footer>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>
<script type="text/javascript" src="/js/MathJax.js"></script>
</body>
</html>